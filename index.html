<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCNA 대화형 학습 SPA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* 기본 네비게이션 버튼 스타일 */
        .nav-button {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .nav-button.active {
            background-color: #3b82f6; /* bg-blue-600 */
            color: white;
        }
        /* 챕터 네비게이션 버튼 특별 스타일 */
        #chapter-nav .nav-button.active {
            background-color: #1e40af; /* bg-blue-800 */
            color: white;
        }
        /* 하위 주제 네비게이션 버튼 특별 스타일 */
        #sub-topic-nav .nav-button.active {
            background-color: #60a5fa; /* bg-blue-400 */
            color: white;
        }

        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .layer-box {
            border: 2px solid transparent;
            transition: transform 0.2s ease-in-out, border-color 0.2s ease-in-out, background-color 0.2s ease-in-out;
        }
        .layer-box:hover {
            transform: translateY(-5px);
            border-color: #3b82f6;
        }
        .layer-box.selected {
            background-color: #bfdbfe;
            border-color: #2563eb;
        }
        .characteristic-card {
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .characteristic-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .details-pane {
            min-height: 150px;
        }
        .details-pane::-webkit-scrollbar {
            width: 8px;
        }
        .details-pane::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .details-pane::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 4px;
        }
        .details-pane::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
        .comparison-grid > div {
            border: 1px solid #e5e7eb;
        }
        /* 네비게이션 바 높이 고정 및 스티키 동작을 위한 스타일 */
        #chapter-nav {
            height: 50px; /* 챕터 네비게이션 높이 예시 */
        }
        #sub-topic-nav {
            top: 50px; /* 챕터 네비게이션 높이만큼 내려옴 */
            height: 46px; /* 하위 주제 네비게이션 높이 예시 */
        }
        main {
             padding-top: 10px; /* 하위 네비게이션과 콘텐츠 사이 간격 */
        }
    </style>
</head>
<body class="bg-stone-100 text-stone-800">
    <header class="bg-sky-700 text-white shadow-lg">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-3">
            <h1 class="text-2xl sm:text-3xl font-bold text-center">CCNA 대화형 학습기</h1>
        </div>
    </header>

    <nav id="chapter-nav" class="bg-sky-600 text-white shadow-md sticky top-0 z-50 flex flex-wrap justify-center items-center space-x-2 sm:space-x-4 px-4">
        </nav>

    <nav id="sub-topic-nav" class="bg-stone-200 shadow-md sticky z-40">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div id="sub-topic-buttons-container" class="flex flex-wrap justify-center space-x-2 sm:space-x-4 py-2">
                </div>
        </div>
    </nav>

    <main class="container mx-auto p-4 sm:p-6 lg:p-8">
        <section id="basics" data-chapter-id="chapter3" class="content-section">
            <h2 class="text-2xl font-semibold mb-6 text-sky-700"><span class="chapter-title-display"></span>네트워킹 기본</h2>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">네트워크란 무엇인가?</h3>
                <p class="text-stone-600 leading-relaxed">
                    네트워크는 지리적으로 분산된 장치(컴퓨터, 서버, 라우터 등)들을 서로 연결하여 정보를 교환하고 자원을 공유할 수 있도록 하는 통신 시스템입니다. 예를 들어, 인터넷은 전 세계의 수많은 네트워크들을 연결하는 거대한 광역 네트워크(WAN)의 한 예입니다. 이를 통해 뉴욕과 보스턴, 혹은 서울과 런던처럼 멀리 떨어진 곳에서도 데이터를 주고받을 수 있습니다. 이 섹션에서는 네트워크의 기초와 주요 특성들을 살펴봅니다.
                </p>
            </div>
            <h3 class="text-xl font-semibold mb-4 text-stone-700">주요 네트워크 특성</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 characteristic-cards-container">
                </div>
            <div id="characteristic-details" class="mt-6 bg-white p-6 rounded-lg shadow-lg min-h-[100px]">
                <p class="text-stone-500 italic">위의 특성 중 하나를 클릭하여 설명을 확인하세요.</p>
            </div>
        </section>

        <section id="osi" data-chapter-id="chapter3" class="content-section">
            <h2 class="text-2xl font-semibold mb-6 text-sky-700"><span class="chapter-title-display"></span>OSI 모델</h2>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">OSI 모델 개요</h3>
                <p class="text-stone-600 leading-relaxed mb-2">
                    OSI(Open Systems Interconnection) 모델은 국제 표준화 기구(ISO)에서 개발한 네트워크 통신을 위한 개념적 프레임워크입니다. 이 모델은 복잡한 네트워크 통신 과정을 7개의 추상적인 계층으로 나누어 설명함으로써, 서로 다른 시스템 간의 상호 운용성을 확보하고 네트워크 기술 개발 및 학습을 용이하게 합니다.
                </p>
                <p class="text-stone-600 leading-relaxed">
                    아래 다이어그램에서 각 계층을 클릭하여 상세 정보(기능, PDU, 관련 장비 등)를 확인해보세요.
                </p>
            </div>
            <div class="flex flex-col lg:flex-row gap-6">
                <div id="osi-layers-diagram" class="lg:w-1/3 grid grid-cols-1 gap-2"></div>
                <div id="osi-layer-details" class="lg:w-2/3 bg-white p-6 rounded-lg shadow-lg details-pane overflow-y-auto">
                    <p class="text-stone-500 italic">왼쪽 다이어그램에서 계층을 선택하여 설명을 확인하세요.</p>
                </div>
            </div>
            <div class="mt-6 bg-white p-6 rounded-lg shadow-lg">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">데이터 캡슐화 및 역캡슐화</h3>
                <p class="text-stone-600 leading-relaxed mb-2"><strong>캡슐화:</strong> 송신 측 데이터는 상위 계층에서 하위 계층으로 이동하면서 헤더(및 트레일러)가 추가됩니다.</p>
                <p class="text-stone-600 leading-relaxed"><strong>역캡슐화:</strong> 수신 측 데이터는 하위 계층에서 상위 계층으로 이동하면서 헤더(및 트레일러)가 제거됩니다.</p>
            </div>
             <div class="mt-6 bg-white p-6 rounded-lg shadow-lg">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">OSI 모델의 이점</h3>
                 <ul class="list-disc list-inside text-stone-600 leading-relaxed space-y-1">
                    <li>네트워크 통신의 복잡성을 줄이고 계층별로 나누어 이해하기 쉽게 합니다.</li>
                    <li>표준화를 통해 여러 제조업체의 장비 간 상호 운용성을 증진시킵니다.</li>
                    <li>특정 계층의 변경이 다른 계층에 미치는 영향을 최소화하여 기술 개발과 유지보수를 용이하게 합니다.</li>
                </ul>
            </div>
        </section>

        <section id="tcpip" data-chapter-id="chapter3" class="content-section">
            <h2 class="text-2xl font-semibold mb-6 text-sky-700"><span class="chapter-title-display"></span>TCP/IP 스택</h2>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">TCP/IP 스택 개요</h3>
                <p class="text-stone-600 leading-relaxed mb-2">
                    TCP/IP 스택은 현재 인터넷 및 대부분의 컴퓨터 네트워크에서 사용되는 주요 프로토콜 모음입니다. OSI 모델보다 먼저 등장하여 사실상의 표준으로 자리 잡았습니다.
                </p>
                 <p class="text-stone-600 leading-relaxed">
                    아래 다이어그램에서 각 계층을 클릭하여 상세 정보(기능, 주요 프로토콜, PDU 등)를 확인해보세요.
                </p>
            </div>
            <div class="flex flex-col lg:flex-row gap-6">
                <div id="tcpip-layers-diagram" class="lg:w-1/3 grid grid-cols-1 gap-2"></div>
                <div id="tcpip-layer-details" class="lg:w-2/3 bg-white p-6 rounded-lg shadow-lg details-pane overflow-y-auto">
                     <p class="text-stone-500 italic">왼쪽 다이어그램에서 계층을 선택하여 설명을 확인하세요.</p>
                </div>
            </div>
        </section>

        <section id="comparison" data-chapter-id="chapter3" class="content-section">
            <h2 class="text-2xl font-semibold mb-6 text-sky-700"><span class="chapter-title-display"></span>모델 비교</h2>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">두 모델의 관계</h3>
                <p class="text-stone-600 leading-relaxed">
                    OSI 모델은 7계층의 이론적 프레임워크, TCP/IP 스택은 4계층(또는 5계층)의 실질적인 프로토콜 모음입니다.
                </p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg overflow-x-auto">
                <div class="grid grid-cols-2 gap-0 min-w-[600px] comparison-grid">
                    <div class="font-bold text-lg p-3 bg-stone-200 text-stone-700 text-center">OSI 모델 (7 계층)</div>
                    <div class="font-bold text-lg p-3 bg-stone-200 text-stone-700 text-center">TCP/IP 스택 (4 계층)</div>
                    <div class="p-3 border-t-0">7. 응용 계층</div> <div class="p-3 row-span-3 border-l-0 border-t-0 flex items-center justify-center bg-sky-50">응용 계층</div>
                    <div class="p-3">6. 표현 계층</div>
                    <div class="p-3">5. 세션 계층</div>
                    <div class="p-3 bg-emerald-50">4. 전송 계층</div> <div class="p-3 bg-emerald-50 border-l-0 flex items-center justify-center">전송 계층</div>
                    <div class="p-3 bg-amber-50">3. 네트워크 계층</div> <div class="p-3 bg-amber-50 border-l-0 flex items-center justify-center">인터넷 계층</div>
                    <div class="p-3">2. 데이터 링크 계층</div> <div class="p-3 row-span-2 border-l-0 flex items-center justify-center bg-rose-50">네트워크 액세스 계층</div>
                    <div class="p-3">1. 물리 계층</div>
                </div>
            </div>
        </section>

        <section id="cisco_os" data-chapter-id="chapter4" class="content-section">
            <h2 class="text-2xl font-semibold mb-6 text-sky-700"><span class="chapter-title-display"></span>Cisco 운영체제</h2>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">Cisco 운영체제의 간략한 역사</h3>
                <ul class="list-disc list-inside text-stone-600 leading-relaxed space-y-2">
                    <li>Cisco는 1984년 라우터로 시작, IOS(Internetwork Operating System) 사용.</li>
                    <li>Catalyst 스위치는 1993년 Crescendo 인수, 초기 CatOS 사용 (현재 미사용).</li>
                    <li>Cisco 방화벽은 1995년 Network Translation의 PIX 방화벽 인수.</li>
                    <li>이후 스위치와 방화벽은 IOS로 통합.</li>
                </ul>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">기타 Cisco 운영체제</h3>
                 <ul class="list-disc list-inside text-stone-600 leading-relaxed space-y-2">
                    <li>IOS는 여전히 대부분의 Cisco 기업용 네트워크 장비의 주요 OS.</li>
                    <li>최근 개발된 다른 OS: NX-OS (Nexus, MDS), IOS-XR (NCS, CRS 등), IOS-XE (ASR1000).</li>
                    <li>다른 OS들의 CLI는 IOS와 거의 동일.</li>
                </ul>
            </div>
        </section>

        <section id="cisco_connect" data-chapter-id="chapter4" class="content-section">
            <h2 class="text-2xl font-semibold mb-6 text-sky-700"><span class="chapter-title-display"></span>Cisco 장비 연결</h2>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">초기 연결 (콘솔)</h3>
                <p class="text-stone-600 leading-relaxed">Cisco 장비는 기본 IP 주소가 없는 경우가 많아 초기 설정 시 콘솔 연결이 필요합니다. 콘솔 케이블(DB9-RJ45 또는 USB-MiniUSB)을 사용하여 장비의 콘솔 포트와 PC를 연결합니다. Putty와 같은 터미널 에뮬레이터를 사용합니다. (Packet Tracer에서는 시뮬레이션으로 대체)</p>
                 <ul class="list-disc list-inside text-stone-600 leading-relaxed space-y-1 mt-2">
                    <li>콘솔 연결은 장비 부팅 과정 확인 및 IP 응답 불가 시 문제 해결에도 사용됩니다.</li>
                 </ul>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">네트워크를 통한 연결 (SSH/Telnet)</h3>
                <p class="text-stone-600 leading-relaxed">일상적인 관리는 SSH(Secure Shell)를 통해 장비의 관리 IP 주소로 접속합니다. Telnet도 지원되지만 보안에 취약하여 권장되지 않습니다. 기업 환경에서는 AAA 서버와 연동하여 보안 로그인을 강화합니다.</p>
                <p class="text-stone-600 leading-relaxed mt-2"><strong>Out-of-Band Management:</strong> 운영 트래픽과 관리 트래픽을 분리하기 위해 별도의 관리 네트워크를 구성하는 방식입니다.</p>
            </div>
        </section>

        <section id="cisco_ios_nav" data-chapter-id="chapter4" class="content-section">
            <h2 class="text-2xl font-semibold mb-6 text-sky-700"><span class="chapter-title-display"></span>IOS 네비게이션</h2>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">명령어 계층 (Command Hierarchy)</h3>
                <ul class="list-disc list-inside text-stone-600 leading-relaxed space-y-1">
                    <li><strong>User Exec mode:</strong> `hostname&gt;` (기본 정보 확인)</li>
                    <li><strong>Privileged Exec mode:</strong> `hostname#` (모든 정보 확인, 설정 변경 시작. `enable` 명령어로 진입)</li>
                    <li><strong>Global Configuration mode:</strong> `hostname(config)#` (전역 설정. `configure terminal` 명령어로 진입)</li>
                    <li><strong>Interface Configuration mode:</strong> `hostname(config-if)#` (인터페이스 설정. `interface [타입 슬롯/포트]` 명령어로 진입)</li>
                    <li>`exit`는 한 단계 위로, `end`는 Privileged Exec 모드로 바로 이동.</li>
                </ul>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">유용한 CLI 기능</h3>
                <ul class="list-disc list-inside text-stone-600 leading-relaxed space-y-1">
                    <li><strong>명령어 축약:</strong> 고유하게 식별되는 한 짧게 입력 가능 (예: `en` for `enable`).</li>
                    <li><strong>Context Sensitive Help (?):</strong> `sh?` (sh로 시작하는 명령어), `show ?` (show 다음 옵션), `show ip ?` (show ip 다음 옵션).</li>
                    <li><strong>커서 이동:</strong> 화살표 키, Ctrl-A (줄 처음), Ctrl-U (줄 삭제).</li>
                    <li><strong>명령어 히스토리:</strong> 위/아래 화살표 키.</li>
                    <li><strong>출력 제어:</strong> Enter (한 줄씩), Spacebar (한 페이지씩), Ctrl-C (중단).</li>
                    <li><strong>Piped Commands (|):</strong> `show running-config | include FastEthernet0/0` (특정 문자열 포함 라인만 표시).</li>
                </ul>
            </div>
        </section>

        <section id="cisco_config_mgmt" data-chapter-id="chapter4" class="content-section">
            <h2 class="text-2xl font-semibold mb-6 text-sky-700"><span class="chapter-title-display"></span>IOS 설정 관리</h2>
            <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">설정 저장 위치</h3>
                <ul class="list-disc list-inside text-stone-600 leading-relaxed space-y-1">
                    <li><strong>Flash:</strong> IOS 운영체제 이미지 저장.</li>
                    <li><strong>NVRAM (Non-Volatile RAM):</strong> Startup Configuration (시작 설정) 저장. 부팅 시 이 설정을 사용.</li>
                    <li><strong>RAM (Random Access Memory):</strong> Running Configuration (현재 실행 중인 설정) 저장. 장비 부팅 시 Startup Config가 RAM으로 로드됨.</li>
                </ul>
            </div>
             <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
                <h3 class="text-xl font-semibold mb-3 text-stone-700">설정 저장 및 초기화</h3>
                <ul class="list-disc list-inside text-stone-600 leading-relaxed space-y-1">
                    <li>명령어는 즉시 적용되지만, 재부팅 시 사라집니다 (Running Config에만 반영).</li>
                    <li><strong>설정 저장 (영구 보존):</strong> `copy running-config startup-config` 또는 `wr` (축약형).</li>
                    <li><strong>설정 초기화 (공장 초기화):</strong> `erase startup-config` 또는 `wr erase` 후 `reload` (재부팅).</li>
                </ul>
            </div>
        </section>
    </main>

    <footer class="bg-stone-800 text-stone-300 text-center p-6 mt-12">
        <p>&copy; 2025 CCNA 학습 자료. Flackbox PDF 내용 기반.</p>
    </footer>

    <script>
        // Data for chapters and their sections
        const studyMaterials = [
            {
                id: 'chapter3',
                shortTitle: '제3장',
                fullTitle: '제3장: 네트워크 모델 및 기본',
                sections: [
                    { id: 'basics', title: '네트워킹 기본' },
                    { id: 'osi', title: 'OSI 모델' },
                    { id: 'tcpip', title: 'TCP/IP 스택' },
                    { id: 'comparison', title: '모델 비교' }
                ]
            },
            {
                id: 'chapter4',
                shortTitle: '제4장',
                fullTitle: '제4장: Cisco IOS 시작하기',
                sections: [
                    { id: 'cisco_os', title: 'Cisco OS' },
                    { id: 'cisco_connect', title: 'Cisco 장비 연결' },
                    { id: 'cisco_ios_nav', title: 'IOS 네비게이션' },
                    { id: 'cisco_config_mgmt', title: 'IOS 설정 관리' }
                ]
            }
            // Add more chapters here in the future
        ];

        const chapterNavContainer = document.getElementById('chapter-nav');
        const subTopicButtonsContainer = document.getElementById('sub-topic-buttons-container');
        const allContentSections = document.querySelectorAll('.content-section');
        
        // Store references to specific detail elements for OSI and Basics
        const characteristicDetailsDiv = document.getElementById('characteristic-details');
        const osiLayersDiagramDiv = document.getElementById('osi-layers-diagram');
        const osiLayerDetailsDiv = document.getElementById('osi-layer-details');
        const tcpipLayersDiagramDiv = document.getElementById('tcpip-layers-diagram');
        const tcpipLayerDetailsDiv = document.getElementById('tcpip-layer-details');

        // Data for interactive elements (OSI, TCP/IP, Basics) - kept from original for functionality
        const networkCharacteristicsData = [
            { id: 'topology', name: '토폴로지', description: '네트워크의 물리적 또는 논리적 연결 구조. 예: 스타형, 버스형, 링형, 메시형.' },
            { id: 'speed', name: '속도', description: '데이터 전송 빠르기 (Mbps, Gbps). 대역폭, 지연 시간 등 영향.' },
            { id: 'cost', name: '비용', description: '네트워크 구축 및 유지보수 비용.' },
            { id: 'security', name: '보안', description: '네트워크 자산 보호. 방화벽, VPN, 암호화 등.' },
            { id: 'availability', name: '가용성', description: '네트워크 정상 작동 시간 비율. 이중화 등.' },
            { id: 'scalability', name: '확장성', description: '성능 저하 없이 확장 능력.' },
            { id: 'reliability', name: '신뢰성', description: '고장 없이 일관되게 작동하는 정도.' }
        ];
        const osiLayersData = [
            { name: '7. 응용 계층', pdu: '데이터', color: 'bg-purple-100', hoverColor: 'hover:bg-purple-200', details: '사용자 앱에 네트워크 서비스 제공. HTTP, FTP, SMTP, DNS 등.', devices: '호스트, 게이트웨이'},
            { name: '6. 표현 계층', pdu: '데이터', color: 'bg-indigo-100', hoverColor: 'hover:bg-indigo-200', details: '데이터 형식 정의, 암호화, 압축. 예: ASCII, JPEG.', devices: '호스트, 게이트웨이' },
            { name: '5. 세션 계층', pdu: '데이터', color: 'bg-blue-100', hoverColor: 'hover:bg-blue-200', details: '호스트 간 세션 설정, 관리, 종료. 예: NetBIOS, RPC.', devices: '호스트, 게이트웨이' },
            { name: '4. 전송 계층', pdu: '세그먼트/데이터그램', color: 'bg-green-100', hoverColor: 'hover:bg-green-200', details: '종단 간 신뢰성/정확한 데이터 전송. TCP, UDP. 흐름/오류 제어.', devices: '호스트, 방화벽' },
            { name: '3. 네트워크 계층', pdu: '패킷', color: 'bg-yellow-100', hoverColor: 'hover:bg-yellow-200', details: '경로 선택(라우팅), IP 주소 사용 논리적 주소 지정. IP 프로토콜.', devices: '라우터, L3 스위치' },
            { name: '2. 데이터 링크 계층', pdu: '프레임', color: 'bg-orange-100', hoverColor: 'hover:bg-orange-200', details: '물리적 링크 신뢰성 있는 데이터 전송. MAC 주소 사용 물리적 주소 지정. 이더넷, PPP.', devices: '스위치, 브리지, NIC' },
            { name: '1. 물리 계층', pdu: '비트', color: 'bg-red-100', hoverColor: 'hover:bg-red-200', details: '데이터를 전기/광/무선 신호로 변환 전송. 케이블, 커넥터 등 정의.', devices: '허브, 리피터, 케이블' }
        ].reverse();
        const tcpIpLayersData = [
            { name: '4. 응용 계층', pdu: '데이터', color: 'bg-purple-100', hoverColor: 'hover:bg-purple-200', details: 'OSI의 응용,표현,세션 기능 포함. HTTP, FTP, SMTP 등.', protocols: 'HTTP, FTP, SMTP, DNS' },
            { name: '3. 전송 계층', pdu: '세그먼트/데이터그램', color: 'bg-green-100', hoverColor: 'hover:bg-green-200', details: '종단 간 통신, 신뢰성/흐름 제어. TCP, UDP.', protocols: 'TCP, UDP' },
            { name: '2. 인터넷 계층', pdu: '패킷', color: 'bg-yellow-100', hoverColor: 'hover:bg-yellow-200', details: '경로 결정(라우팅), 논리적 주소 지정(IP). IP, ICMP 등.', protocols: 'IP, ICMP, IGMP' },
            { name: '1. 네트워크 액세스 계층', pdu: '프레임', color: 'bg-red-100', hoverColor: 'hover:bg-red-200', details: 'OSI의 데이터링크,물리 기능 결합. 이더넷, Wi-Fi 등.', protocols: 'Ethernet, Wi-Fi' }
        ].reverse();


        function renderChapterNav() {
            chapterNavContainer.innerHTML = ''; // Clear existing buttons
            studyMaterials.forEach(chapter => {
                const button = document.createElement('button');
                button.className = 'nav-button text-sm sm:text-base font-medium px-3 py-2 sm:px-4 rounded-md hover:bg-sky-500 hover:text-white';
                button.textContent = chapter.shortTitle;
                button.dataset.chapterId = chapter.id;
                button.addEventListener('click', () => {
                    handleChapterSelect(chapter.id);
                });
                chapterNavContainer.appendChild(button);
            });
        }

        function handleChapterSelect(selectedChapterId) {
            // Update active state for chapter buttons
            document.querySelectorAll('#chapter-nav .nav-button').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.chapterId === selectedChapterId);
            });

            renderSubTopicNav(selectedChapterId);
            
            // Automatically select and display the first sub-topic of the newly selected chapter
            const chapterData = studyMaterials.find(ch => ch.id === selectedChapterId);
            if (chapterData && chapterData.sections.length > 0) {
                handleSubTopicSelect(selectedChapterId, chapterData.sections[0].id);
                 // Ensure the first sub-topic button is also marked active
                const firstSubTopicButton = subTopicButtonsContainer.querySelector(`.nav-button[data-target="${chapterData.sections[0].id}"]`);
                if (firstSubTopicButton) {
                    document.querySelectorAll('#sub-topic-buttons-container .nav-button').forEach(btn => btn.classList.remove('active'));
                    firstSubTopicButton.classList.add('active');
                }
            } else {
                 // If no sections, hide all content
                allContentSections.forEach(section => section.classList.remove('active'));
            }
        }

        function renderSubTopicNav(chapterId) {
            subTopicButtonsContainer.innerHTML = ''; // Clear existing buttons
            const chapter = studyMaterials.find(ch => ch.id === chapterId);
            if (!chapter) return;

            chapter.sections.forEach(section => {
                const button = document.createElement('button');
                button.className = 'nav-button text-xs sm:text-sm font-medium px-2 py-1 sm:px-3 sm:py-2 rounded-md hover:bg-sky-300 hover:text-sky-800';
                button.textContent = section.title;
                button.dataset.target = section.id; // Used to link to content section
                button.dataset.chapterId = chapterId; // Keep track of parent chapter
                button.addEventListener('click', () => {
                    handleSubTopicSelect(chapterId, section.id);
                     // Update active state for sub-topic buttons
                    document.querySelectorAll('#sub-topic-buttons-container .nav-button').forEach(btn => {
                        btn.classList.toggle('active', btn.dataset.target === section.id);
                    });
                });
                subTopicButtonsContainer.appendChild(button);
            });
        }

        function handleSubTopicSelect(chapterId, sectionId) {
            allContentSections.forEach(sectionEl => {
                // Hide if not the selected section OR if it doesn't belong to the current chapter
                const isCorrectSection = sectionEl.id === sectionId && sectionEl.dataset.chapterId === chapterId;
                sectionEl.classList.toggle('active', isCorrectSection);

                if(isCorrectSection) {
                    // Update chapter title display in the active section
                    const chapterData = studyMaterials.find(ch => ch.id === chapterId);
                    const chapterTitleDisplay = sectionEl.querySelector('.chapter-title-display');
                    if (chapterTitleDisplay && chapterData) {
                        chapterTitleDisplay.textContent = chapterData.fullTitle + ": ";
                    }

                    // Reset specific interactive elements if they are in the current section
                    if (sectionId === 'basics' && characteristicDetailsDiv) {
                        characteristicDetailsDiv.innerHTML = '<p class="text-stone-500 italic">위의 특성 중 하나를 클릭하여 설명을 확인하세요.</p>';
                    } else if (sectionId === 'osi' && osiLayerDetailsDiv) {
                        osiLayerDetailsDiv.innerHTML = '<p class="text-stone-500 italic">왼쪽 다이어그램에서 계층을 선택하여 설명을 확인하세요.</p>';
                        document.querySelectorAll('#osi-layers-diagram .layer-box.selected').forEach(box => box.classList.remove('selected'));
                    } else if (sectionId === 'tcpip' && tcpipLayerDetailsDiv) {
                        tcpipLayerDetailsDiv.innerHTML = '<p class="text-stone-500 italic">왼쪽 다이어그램에서 계층을 선택하여 설명을 확인하세요.</p>';
                        document.querySelectorAll('#tcpip-layers-diagram .layer-box.selected').forEach(box => box.classList.remove('selected'));
                    }
                }
            });
        }
        
        // Functions for interactive elements (OSI, TCP/IP, Basics)
        function renderNetworkCharacteristics() {
            const container = document.querySelector('#basics .characteristic-cards-container');
            if (!container) return;
            container.innerHTML = ''; 
            networkCharacteristicsData.forEach(char => {
                const card = document.createElement('div');
                card.className = 'characteristic-card bg-white p-4 rounded-lg shadow hover:shadow-md cursor-pointer';
                card.innerHTML = `<h4 class="font-semibold text-md text-sky-600">${char.name}</h4>`;
                card.addEventListener('click', () => {
                    if (characteristicDetailsDiv) {
                        characteristicDetailsDiv.innerHTML = `
                            <h4 class="font-semibold text-lg text-sky-700 mb-2">${char.name}</h4>
                            <p class="text-stone-600 leading-relaxed">${char.description}</p>`;
                    }
                });
                container.appendChild(card);
            });
        }
        
        function createLayerBox(layerData, detailsDiv, diagramId) {
            const layerBox = document.createElement('div');
            layerBox.className = `layer-box p-4 rounded-md shadow text-center cursor-pointer ${layerData.color} ${layerData.hoverColor} text-stone-700 font-medium`;
            layerBox.textContent = layerData.name;
            layerBox.addEventListener('click', () => {
                document.querySelectorAll(`#${diagramId} .layer-box`).forEach(box => box.classList.remove('selected'));
                layerBox.classList.add('selected');
                
                let detailsHtml = `
                    <h3 class="text-xl font-bold text-sky-700 mb-3">${layerData.name}</h3>
                    <p class="text-stone-600 leading-relaxed mb-2"><strong>PDU:</strong> ${layerData.pdu}</p>
                    <p class="text-stone-600 leading-relaxed mb-2"><strong>주요 기능 및 설명:</strong> ${layerData.details}</p>`;
                if (diagramId === 'osi-layers-diagram' && layerData.devices) {
                     detailsHtml += `<p class="text-stone-600 leading-relaxed"><strong>관련 장비:</strong> ${layerData.devices}</p>`;
                }
                if (diagramId === 'tcpip-layers-diagram' && layerData.protocols) {
                     detailsHtml += `<p class="text-stone-600 leading-relaxed"><strong>주요 프로토콜:</strong> ${layerData.protocols}</p>`;
                }
                if (detailsDiv) {
                    detailsDiv.innerHTML = detailsHtml;
                }
            });
            return layerBox;
        }

        function renderOsiLayers() {
            if (!osiLayersDiagramDiv) return;
            osiLayersDiagramDiv.innerHTML = '';
            osiLayersData.forEach(layer => {
                const layerBox = createLayerBox(layer, osiLayerDetailsDiv, 'osi-layers-diagram');
                osiLayersDiagramDiv.appendChild(layerBox);
            });
        }

        function renderTcpIpLayers() {
            if (!tcpipLayersDiagramDiv) return;
            tcpipLayersDiagramDiv.innerHTML = '';
            tcpIpLayersData.forEach(layer => {
                const layerBox = createLayerBox(layer, tcpipLayerDetailsDiv, 'tcpip-layers-diagram');
                tcpipLayersDiagramDiv.appendChild(layerBox);
            });
        }

        // Initial setup
        function initApp() {
            renderChapterNav();
            // Render interactive elements for sections that need them
            renderNetworkCharacteristics(); // For 'basics' section
            renderOsiLayers(); // For 'osi' section
            renderTcpIpLayers(); // For 'tcpip' section

            // Activate the first chapter and its first section by default
            if (studyMaterials.length > 0) {
                handleChapterSelect(studyMaterials[0].id);
            }
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
